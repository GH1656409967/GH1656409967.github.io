<!DOCTYPE html>
<html dir="auto" lang="zh">
<head><meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<meta content="index, follow" name="robots"/>
<title>HDU-3613 Best Reward | ä¼¼æ°´</title>
<meta content="HDU, Manacher, kuangbin ä¸“é¢˜åå…­" name="keywords"/>
<meta content="HDU-3613 Best Reward ç±»å‹ Manacher" name="description"/>
<meta content="Lordash" name="author"/>
<link href="https://blog.lordash.de/posts/solution/hdu-3613-best-reward/" rel="canonical"/>
<link as="style" crossorigin="anonymous" href="/assets/css/stylesheet.d8fdb0c2c6146370b30ec48466810665fac739001d0785f10d28d79629b34769.css" integrity="sha256-2P2wwsYUY3CzDsSEZoEGZfrHOQAdB4XxDSjXlimzR2k=" rel="preload stylesheet"/>
<link href="https://blog.lordash.de/assets/images/favicon-16x16-.png" rel="icon"/>
<link href="https://blog.lordash.de/assets/images/favicon-16x16-.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="https://blog.lordash.de/assets/images/favicon-32x32-.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="https://blog.lordash.de/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="https://blog.lordash.de/safari-pinned-tab.svg" rel="mask-icon"/>
<meta content="#2e2e33" name="theme-color"/>
<meta content="#2e2e33" name="msapplication-TileColor"/>
<noscript>
<style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
<style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/lxgwwenkaiscreen.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<meta content="HDU-3613 Best Reward" property="og:title"/>
<meta content="HDU-3613 Best Reward ç±»å‹ Manacher" property="og:description"/>
<meta content="article" property="og:type"/>
<meta content="https://blog.lordash.de/posts/solution/hdu-3613-best-reward/" property="og:url"/><meta content="posts" property="article:section"/>
<meta content="2020-08-05T19:41:38+00:00" property="article:published_time"/>
<meta content="2020-08-05T19:41:38+00:00" property="article:modified_time"/>
<meta content="summary" name="twitter:card"/>
<meta content="HDU-3613 Best Reward" name="twitter:title"/>
<meta content="HDU-3613 Best Reward ç±»å‹ Manacher" name="twitter:description"/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "æ–‡ç« ",
      "item": "https://blog.lordash.de/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "é¢˜è§£",
      "item": "https://blog.lordash.de/posts/solution/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "HDU-3613 Best Reward",
      "item": "https://blog.lordash.de/posts/solution/hdu-3613-best-reward/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "HDU-3613 Best Reward",
  "name": "HDU-3613 Best Reward",
  "description": "HDU-3613 Best Reward ç±»å‹ Manacher",
  "keywords": [
    "HDU", "Manacher", "kuangbin ä¸“é¢˜åå…­"
  ],
  "articleBody": "Best Reward(HDU-3613) é¢˜é¢ After an uphill battle, General Li won a great victory. Now the head of state decide to reward him with honor and treasures for his great exploit.\nOne of these treasures is a necklace made up of 26 different kinds of gemstones, and the length of the necklace is n. (That is to say: n gemstones are stringed together to constitute this necklace, and each of these gemstones belongs to only one of the 26 kinds.)\nIn accordance with the classical view, a necklace is valuable if and only if it is a palindrome - the necklace looks the same in either direction. However, the necklace we mentioned above may not a palindrome at the beginning. So the head of state decide to cut the necklace into two part, and then give both of them to General Li.\nAll gemstones of the same kind has the same value (may be positive or negative because of their quality - some kinds are beautiful while some others may looks just like normal stones). A necklace that is palindrom has value equal to the sum of its gemstonesâ€™ value. while a necklace that is not palindrom has value zero.\nNow the problem is: how to cut the given necklace so that the sum of the two necklacesâ€™s value is greatest. Output this value.\nè¾“å…¥ The first line of input is a single integer T (1 â‰¤ T â‰¤ 10) - the number of test cases. The description of these test cases follows.\nFor each test case, the first line is 26 integers: v1, v2, â€¦, v26 (-100 â‰¤ vi â‰¤ 100, 1 â‰¤ i â‰¤ 26), represent the value of gemstones of each kind.\nThe second line of each test case is a string made up of charactor â€˜aâ€™ to â€˜zâ€™. representing the necklace. Different charactor representing different kinds of gemstones, and the value of â€˜aâ€™ is v1, the value of â€˜bâ€™ is v2, â€¦, and so on. The length of the string is no more than 500000.\nè¾“å‡º Output a single Integer: the maximum value General Li can get from the necklace.\næ ·ä¾‹è¾“å…¥ 12 21 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3aba 41 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5acacac æ ·ä¾‹è¾“å‡º 11 26 æç¤º æ— \næ€è·¯ å°†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè‹¥æŸä¸€å­ä¸²æ˜¯å›æ–‡ä¸²ï¼Œåˆ™è¯¥å­ä¸²çš„ä»·å€¼ä¸ºå„å­—ç¬¦çš„æƒå€¼å’Œï¼Œå¦åˆ™ä»·å€¼ä¸º0ã€‚æ±‚ä¸€ç§åˆ†å‰²æ–¹æ³•ï¼Œä½¿å¾—ä¸¤éƒ¨åˆ†ä»·å€¼å’Œæœ€å¤§ã€‚\né¦–å…ˆè·‘ä¸€éManacherï¼Œå¯¹äºåŸä¸²çš„å‰ç¼€å›æ–‡å­ä¸²ï¼Œæ»¡è¶³ä¸­å¿ƒç‚¹i==p[i]ï¼Œè€Œå¯¹äºåŸä¸²çš„åç¼€å›æ–‡å­ä¸²ï¼Œæ»¡è¶³ä¸­å¿ƒç‚¹i+p[i] == å¤„ç†è¿‡çš„åŸä¸²é•¿åº¦ å³2*len(åŸä¸²)+2ã€‚iä¸ºå¤„ç†è¿‡çš„å­—ç¬¦ä¸²æ•°ç»„ä¸‹æ ‡ï¼Œpæ•°ç»„æ˜¯æœ€å¤§å›æ–‡åŠå¾„ã€‚\næ‰€ä»¥æšä¸¾n+n-1ä¸ªå›æ–‡ä¸­å¿ƒï¼Œçœ‹æ˜¯å¦æ˜¯åŸä¸²çš„å‰ç¼€å›æ–‡å­ä¸²ï¼Œè®¨è®ºå‰©ä¸‹çš„éƒ¨åˆ†ï¼Œè‹¥å‰©ä¸‹éƒ¨åˆ†æ˜¯å›æ–‡ä¸²ï¼Œåˆ™å¯èƒ½çš„å›æ–‡ä¸­å¿ƒr = (å¤„ç†è¿‡çš„åŸä¸²é•¿åº¦n + å‰ç¼€å›æ–‡å­ä¸²çš„å³ç«¯ç‚¹i+p[i]-1) / 2ï¼Œä»¥æ­¤åˆ¤æ–­ååŠéƒ¨åˆ†æ˜¯å¦ä¸ºå›æ–‡ä¸²ï¼Œå–æœ€å¤§ä»·å€¼å’Œå³å¯ã€‚è·å–å›æ–‡å­ä¸²çš„ä»·å€¼å¯ä»¥ç”¨å‰ç¼€å’Œä¼˜åŒ–ã€‚\nä»£ç  1char s[mxn], t[mxn]; 2int p[mxn]; 3 4int manacher_init(char *s, char *t, int n) 5{ 6 int j = 2; t[0] = '$', t[1] = '#'; 7 for (int i=0; i\u003cn; i++) 8 { 9 t[j++] = s[i]; 10 t[j++] = '#'; 11 } 12 t[j] = '\\0'; 13 return j; 14} 15 16int manacher(char *t, int *p, int n) 17{ 18 int id = 0, mx = 0, ans = 0; 19 for (int i=1; i\u003c=n; i++) 20 { 21 p[i] = mx\u003ei ? min(p[2*id-i], mx-i) : 1; 22 23 while (t[i+p[i]] == t[i-p[i]]) p[i]++; 24 25 if (mx \u003c i+p[i]) 26 mx = i+p[i], id = i; 27 28 ans = max(ans, p[i]); 29 } 30 return ans-1; 31} 32 33int a[30]; 34int sum[mxn]; 35 36int main() 37{ 38 int T; scanf(\"%d\", \u0026T); 39 while(T--) 40 { 41 for(int i=0; i\u003c26; i++) 42 scanf(\"%d\", \u0026a[i]); 43 scanf(\"%s\", s); 44 int n = manacher_init(s, t, strlen(s)); 45 manacher(t, p, n); 46 47 /* å‰ç¼€å’Œ */ 48 sum[0] = sum[1] = 0; 49 for(int i=2; i\u003cn; i++){ 50 sum[i] = i\u00261 ? sum[i-1] : sum[i-2] + a[t[i]-'a']; 51 } 52 53 int ans = 0; 54 for(int i=2; i\u003cn; i++) // æšä¸¾å‰åŠéƒ¨åˆ†å›æ–‡ä¸­å¿ƒ 55 { 56 int a=0, b=0; 57 if(i==p[i]){ // å¦‚æœå‰åŠéƒ¨åˆ†æ˜¯å›æ–‡ä¸² 58 a = sum[i+p[i]-1]; 59 } 60 61 int r = (n + i+p[i]-1)/2; // è·å¾—ååŠéƒ¨åˆ†å›æ–‡ä¸­å¿ƒ 62 if(r == n-1) // å‰åŠéƒ¨åˆ†ä¸ºåŸä¸²ï¼Œæ²¡æœ‰ååŠéƒ¨åˆ† 63 continue; 64 65 if(r+p[r] == n){ // å¦‚æœååŠéƒ¨åˆ†æ˜¯å›æ–‡ä¸² 66 b = sum[n-2] - sum[i+p[i]-1]; 67 } 68 ans = max(ans, a+b); 69 } 70 printf(\"%d\\n\", ans); 71 } 72 73 return 0; 74} ",
  "wordCount" : "1052",
  "inLanguage": "zh",
  "datePublished": "2020-08-05T19:41:38Z",
  "dateModified": "2020-08-05T19:41:38Z",
  "author":{
    "@type": "Person",
    "name": "Lordash"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.lordash.de/posts/solution/hdu-3613-best-reward/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "ä¼¼æ°´",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.lordash.de/assets/images/favicon-16x16-.png"
    }
  }
}
</script>
</head>
<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<header class="header">
<nav class="nav">
<div class="logo">
<a accesskey="h" href="https://blog.lordash.de" title="Lordash's blog (Alt + H)">Lordash's blog</a>
<div class="logo-switches">
<button accesskey="t" id="theme-toggle" title="(Alt + T)">
<svg fill="none" height="18" id="moon" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
</svg>
<svg fill="none" height="18" id="sun" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="5"></circle>
<line x1="12" x2="12" y1="1" y2="3"></line>
<line x1="12" x2="12" y1="21" y2="23"></line>
<line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line>
<line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line>
<line x1="1" x2="3" y1="12" y2="12"></line>
<line x1="21" x2="23" y1="12" y2="12"></line>
<line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line>
<line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line>
</svg>
</button>
</div>
</div>
<ul id="menu">
<li>
<a accesskey="/" href="https://blog.lordash.de/search" title="æœç´¢ (Alt + /)">
<span><i class="fa fa-search"></i>æœç´¢</span>
</a>
</li>
<li>
<a href="https://blog.lordash.de/posts" title="æ–‡ç« ">
<span><i class="fa fa-list"></i>æ–‡ç« </span>
</a>
</li>
<li>
<a href="https://blog.lordash.de/series" title="ä¸“æ ">
<span><i class="fa fa-book"></i>ä¸“æ </span>
</a>
</li>
<li>
<a href="https://blog.lordash.de/f/links" title="å‹é“¾">
<span><i class="fa fa-link"></i>å‹é“¾</span>
</a>
</li>
<li>
<a href="https://blog.lordash.de/f/about" title="å…³äº">
<span><i class="fa fa-info-circle"></i>å…³äº</span>
</a>
</li>
</ul>
</nav>
</header>
<main class="main">
<article class="post-single">
<header class="post-header">
<h1 class="post-title">
      HDU-3613 Best Reward
    </h1>
<div class="post-description">
      HDU-3613 Best Reward ç±»å‹ Manacher
    </div>
<div class="post-meta"><span title="2020-08-05 19:41:38 +0000 UTC">2020-08-05</span>Â Â·Â Lordash



</div>
</header> <aside class="toc-container wide" id="toc-container">
<div class="toc">
<details open="">
<summary accesskey="c" title="(Alt + C)">
<span class="details">ç›®å½•</span>
</summary>
<div class="inner"><ul>
<li>
<a aria-label="Best Reward(HDU-3613)" href="#best-rewardhdu-3613httpsvjudgenetproblemhdu-3613">Best Reward(</a><a href="https://vjudge.net/problem/HDU-3613">HDU-3613</a>)<ul>
<li>
<a aria-label="é¢˜é¢" href="#%e9%a2%98%e9%9d%a2">é¢˜é¢</a></li>
<li>
<a aria-label="è¾“å…¥" href="#%e8%be%93%e5%85%a5">è¾“å…¥</a></li>
<li>
<a aria-label="è¾“å‡º" href="#%e8%be%93%e5%87%ba">è¾“å‡º</a></li>
<li>
<a aria-label="æ ·ä¾‹è¾“å…¥" href="#%e6%a0%b7%e4%be%8b%e8%be%93%e5%85%a5">æ ·ä¾‹è¾“å…¥</a></li>
<li>
<a aria-label="æ ·ä¾‹è¾“å‡º" href="#%e6%a0%b7%e4%be%8b%e8%be%93%e5%87%ba">æ ·ä¾‹è¾“å‡º</a></li>
<li>
<a aria-label="æç¤º" href="#%e6%8f%90%e7%a4%ba">æç¤º</a></li>
<li>
<a aria-label="æ€è·¯" href="#%e6%80%9d%e8%b7%af">æ€è·¯</a></li>
<li>
<a aria-label="ä»£ç " href="#%e4%bb%a3%e7%a0%81">ä»£ç </a>
</li>
</ul>
</li>
</ul>
</div>
</details>
</div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
<div class="post-content"><h1 id="best-rewardhdu-3613httpsvjudgenetproblemhdu-3613">Best Reward(<a href="https://vjudge.net/problem/HDU-3613">HDU-3613</a>)<a aria-hidden="true" class="anchor" hidden="" href="#best-rewardhdu-3613httpsvjudgenetproblemhdu-3613">#</a></h1>
<h2 id="é¢˜é¢">é¢˜é¢<a aria-hidden="true" class="anchor" hidden="" href="#é¢˜é¢">#</a></h2>
<blockquote>
<p>After an uphill battle, General Li won a great victory. Now the head of  state decide to reward him with honor and treasures for his great  exploit.</p>
<p>One of these treasures is a necklace made up of 26 different kinds  of gemstones, and the length of the necklace is n. (That is to say: n  gemstones are stringed together to constitute this necklace, and each of these gemstones belongs to only one of the 26 kinds.)</p>
<p>In accordance with the classical view, a necklace is valuable if  and only if it is a palindrome - the necklace looks the same in either  direction. However, the necklace we mentioned above may not a palindrome at the beginning. So the head of state decide to cut the necklace into  two part, and then give both of them to General Li.</p>
<p>All gemstones of the same kind has the same value (may be positive  or negative because of their quality - some kinds are beautiful while  some others may looks just like normal stones). A necklace that is  palindrom has value equal to the sum of its gemstonesâ€™ value. while a  necklace that is not palindrom has value zero.</p>
<p>Now the problem is: how to cut the given necklace so that the sum of the two necklacesâ€™s value is greatest. Output this value.</p>
</blockquote>
<h2 id="è¾“å…¥">è¾“å…¥<a aria-hidden="true" class="anchor" hidden="" href="#è¾“å…¥">#</a></h2>
<blockquote>
<p>The first line of input is a single integer T (1 â‰¤ T â‰¤ 10) - the number  of test cases. The description of these test cases follows.</p>
<p>For each test case, the first line is 26 integers: v1, v2, â€¦, v26 (-100 â‰¤ vi â‰¤ 100, 1 â‰¤ i â‰¤ 26), represent the value of gemstones of each kind.</p>
<p>The second line of each test case is a string made up of charactor  â€˜aâ€™ to â€˜zâ€™. representing the necklace. Different charactor representing  different kinds of gemstones, and the value of â€˜aâ€™ is v1, the value of â€˜bâ€™ is v2, â€¦, and so on. The length of the string is no more than 500000.</p>
</blockquote>
<h2 id="è¾“å‡º">è¾“å‡º<a aria-hidden="true" class="anchor" hidden="" href="#è¾“å‡º">#</a></h2>
<blockquote>
<p>Output a single Integer: the maximum value General Li can get from the necklace.</p>
</blockquote>
<h2 id="æ ·ä¾‹è¾“å…¥">æ ·ä¾‹è¾“å…¥<a aria-hidden="true" class="anchor" hidden="" href="#æ ·ä¾‹è¾“å…¥">#</a></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>2
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>aba
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>acacac
</span></span></code></pre></div><h2 id="æ ·ä¾‹è¾“å‡º">æ ·ä¾‹è¾“å‡º<a aria-hidden="true" class="anchor" hidden="" href="#æ ·ä¾‹è¾“å‡º">#</a></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>6
</span></span></code></pre></div><h2 id="æç¤º">æç¤º<a aria-hidden="true" class="anchor" hidden="" href="#æç¤º">#</a></h2>
<blockquote>
<p>æ— </p>
</blockquote>
<h2 id="æ€è·¯">æ€è·¯<a aria-hidden="true" class="anchor" hidden="" href="#æ€è·¯">#</a></h2>
<p>å°†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè‹¥æŸä¸€å­ä¸²æ˜¯å›æ–‡ä¸²ï¼Œåˆ™è¯¥å­ä¸²çš„ä»·å€¼ä¸ºå„å­—ç¬¦çš„æƒå€¼å’Œï¼Œå¦åˆ™ä»·å€¼ä¸º0ã€‚æ±‚ä¸€ç§åˆ†å‰²æ–¹æ³•ï¼Œä½¿å¾—ä¸¤éƒ¨åˆ†ä»·å€¼å’Œæœ€å¤§ã€‚</p>
<p>é¦–å…ˆè·‘ä¸€éManacherï¼Œå¯¹äºåŸä¸²çš„å‰ç¼€å›æ–‡å­ä¸²ï¼Œæ»¡è¶³ä¸­å¿ƒç‚¹<code>i==p[i]</code>ï¼Œè€Œå¯¹äºåŸä¸²çš„åç¼€å›æ–‡å­ä¸²ï¼Œæ»¡è¶³ä¸­å¿ƒç‚¹<code>i+p[i] == å¤„ç†è¿‡çš„åŸä¸²é•¿åº¦ å³2*len(åŸä¸²)+2</code>ã€‚iä¸ºå¤„ç†è¿‡çš„å­—ç¬¦ä¸²æ•°ç»„ä¸‹æ ‡ï¼Œpæ•°ç»„æ˜¯æœ€å¤§å›æ–‡åŠå¾„ã€‚</p>
<p>æ‰€ä»¥æšä¸¾n+n-1ä¸ªå›æ–‡ä¸­å¿ƒï¼Œçœ‹æ˜¯å¦æ˜¯åŸä¸²çš„å‰ç¼€å›æ–‡å­ä¸²ï¼Œè®¨è®ºå‰©ä¸‹çš„éƒ¨åˆ†ï¼Œè‹¥å‰©ä¸‹éƒ¨åˆ†æ˜¯å›æ–‡ä¸²ï¼Œåˆ™å¯èƒ½çš„<code>å›æ–‡ä¸­å¿ƒr = (å¤„ç†è¿‡çš„åŸä¸²é•¿åº¦n + å‰ç¼€å›æ–‡å­ä¸²çš„å³ç«¯ç‚¹i+p[i]-1) / 2</code>ï¼Œä»¥æ­¤åˆ¤æ–­ååŠéƒ¨åˆ†æ˜¯å¦ä¸ºå›æ–‡ä¸²ï¼Œå–æœ€å¤§ä»·å€¼å’Œå³å¯ã€‚è·å–å›æ–‡å­ä¸²çš„ä»·å€¼å¯ä»¥ç”¨å‰ç¼€å’Œä¼˜åŒ–ã€‚</p>
<h2 id="ä»£ç ">ä»£ç <a aria-hidden="true" class="anchor" hidden="" href="#ä»£ç ">#</a></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#66d9ef">char</span> s[mxn], t[mxn];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#66d9ef">int</span> p[mxn];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">manacher_init</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>s, <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>t, <span style="color:#66d9ef">int</span> n)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; t[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">'$'</span>, t[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">'#'</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span>n; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>        t[j<span style="color:#f92672">++</span>] <span style="color:#f92672">=</span> s[i];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>        t[j<span style="color:#f92672">++</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">'#'</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>    t[j] <span style="color:#f92672">=</span> <span style="color:#e6db74">'\0'</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>    <span style="color:#66d9ef">return</span> j;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">manacher</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>t, <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>p, <span style="color:#66d9ef">int</span> n)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>    <span style="color:#66d9ef">int</span>  id <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, mx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; i<span style="color:#f92672">&lt;=</span>n; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>        p[i] <span style="color:#f92672">=</span> mx<span style="color:#f92672">&gt;</span>i <span style="color:#f92672">?</span> min(p[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>id<span style="color:#f92672">-</span>i], mx<span style="color:#f92672">-</span>i) <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>        <span style="color:#66d9ef">while</span> (t[i<span style="color:#f92672">+</span>p[i]] <span style="color:#f92672">==</span> t[i<span style="color:#f92672">-</span>p[i]]) p[i]<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>        <span style="color:#66d9ef">if</span> (mx <span style="color:#f92672">&lt;</span> i<span style="color:#f92672">+</span>p[i])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>            mx <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span>p[i], id <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>        ans <span style="color:#f92672">=</span> max(ans, p[i]);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>    <span style="color:#66d9ef">return</span> ans<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span><span style="color:#66d9ef">int</span> a[<span style="color:#ae81ff">30</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span><span style="color:#66d9ef">int</span> sum[mxn];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>    <span style="color:#66d9ef">int</span> T; scanf(<span style="color:#e6db74">"%d"</span>, <span style="color:#f92672">&amp;</span>T);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>    <span style="color:#66d9ef">while</span>(T<span style="color:#f92672">--</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">26</span>; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>            scanf(<span style="color:#e6db74">"%d"</span>, <span style="color:#f92672">&amp;</span>a[i]);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>        scanf(<span style="color:#e6db74">"%s"</span>, s);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>        <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> manacher_init(s, t, strlen(s));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>        manacher(t, p, n);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>        <span style="color:#75715e">/* å‰ç¼€å’Œ */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>        sum[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> sum[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>; i<span style="color:#f92672">&lt;</span>n; i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>            sum[i] <span style="color:#f92672">=</span> i<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> sum[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">:</span> sum[i<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> a[t[i]<span style="color:#f92672">-</span><span style="color:#e6db74">'a'</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>        <span style="color:#66d9ef">int</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>; i<span style="color:#f92672">&lt;</span>n; i<span style="color:#f92672">++</span>)  <span style="color:#75715e">// æšä¸¾å‰åŠéƒ¨åˆ†å›æ–‡ä¸­å¿ƒ
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span><span style="color:#75715e"></span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span>            <span style="color:#66d9ef">int</span> a<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, b<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span>            <span style="color:#66d9ef">if</span>(i<span style="color:#f92672">==</span>p[i]){        <span style="color:#75715e">// å¦‚æœå‰åŠéƒ¨åˆ†æ˜¯å›æ–‡ä¸²
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span><span style="color:#75715e"></span>                a <span style="color:#f92672">=</span> sum[i<span style="color:#f92672">+</span>p[i]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span>            }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span>            <span style="color:#66d9ef">int</span> r <span style="color:#f92672">=</span> (n <span style="color:#f92672">+</span> i<span style="color:#f92672">+</span>p[i]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>;   <span style="color:#75715e">// è·å¾—ååŠéƒ¨åˆ†å›æ–‡ä¸­å¿ƒ
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>(r <span style="color:#f92672">==</span> n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)                <span style="color:#75715e">// å‰åŠéƒ¨åˆ†ä¸ºåŸä¸²ï¼Œæ²¡æœ‰ååŠéƒ¨åˆ†
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span>            <span style="color:#66d9ef">if</span>(r<span style="color:#f92672">+</span>p[r] <span style="color:#f92672">==</span> n){            <span style="color:#75715e">// å¦‚æœååŠéƒ¨åˆ†æ˜¯å›æ–‡ä¸²
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span><span style="color:#75715e"></span>                b <span style="color:#f92672">=</span> sum[n<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> sum[i<span style="color:#f92672">+</span>p[i]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span>            }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span>            ans <span style="color:#f92672">=</span> max(ans, a<span style="color:#f92672">+</span>b);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span><span>        printf(<span style="color:#e6db74">"%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">"</span>, ans);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73</span><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74</span><span>}
</span></span></code></pre></div>
</div>
<footer class="post-footer">
<ul class="post-tags">
<li><a href="https://blog.lordash.de/tags/hdu/">HDU</a></li>
<li><a href="https://blog.lordash.de/tags/manacher/">Manacher</a></li>
<li><a href="https://blog.lordash.de/tags/kuangbin-%E4%B8%93%E9%A2%98%E5%8D%81%E5%85%AD/">kuangbin ä¸“é¢˜åå…­</a></li>
</ul>
<nav class="paginav">
<a class="prev" href="https://blog.lordash.de/posts/algorithm/%E5%AD%97%E5%85%B8%E6%A0%91/">
<span class="title">Â« ä¸Šä¸€é¡µ</span>
<br/>
<span>å­—å…¸æ ‘</span>
</a>
<a class="next" href="https://blog.lordash.de/posts/solution/poj-3746-teacher-yyf/">
<span class="title">ä¸‹ä¸€é¡µ Â»</span>
<br/>
<span>POJ-3746 Teacher YYF</span>
</a>
</nav>
</footer><div>
<div class="pagination__title">
<span class="pagination__title-h" style="font-size: 20px;">ğŸ’¬è¯„è®º</span>
<hr/>
</div>
<div id="tcomment"></div>
<script src="https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js"></script>
<script>
        twikoo.init({
            envId: "https://twikoo-api-dun-pi.vercel.app",
            el: "#tcomment",
            lang: 'zh-CN',
            region: 'ap-zhengzhou',
            path: window.TWIKOO_MAGIC_PATH || window.location.pathname,
        });
    </script>
</div>
</article>
</main>
<footer class="footer">
<span>Â© 2023 <a href="https://blog.lordash.de">ä¼¼æ°´</a></span>
<span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &amp;
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
</span>
</footer>
<a accesskey="g" aria-label="go to top" class="top-link" href="#top" id="top-link" title="Go to Top (Alt + G)">
<svg fill="currentColor" viewbox="0 0 12 6" xmlns="http://www.w3.org/2000/svg">
<path d="M12 6H0l6-6z"></path>
</svg>
</a>
<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                
                let x = codeblock.getElementsByTagName("span");
                let noLineNumContent = "";
                for (i = 0; i < x.length; i++) {
                    if (x[i].style.display || x[i].style.color);
                    else noLineNumContent += x[i].textContent;
                }
                navigator.clipboard.writeText(noLineNumContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const unfoldbtn = document.createElement('button');
        unfoldbtn.classList.add('unfoldbtn');
        unfoldbtn.innerHTML = 'å±•å¼€';

        unfoldbtn.addEventListener('click', (cb) => {
            if (container.firstChild.firstChild.classList.contains('unfold')) {
                container.firstChild.firstChild.classList.remove('unfold');
                unfoldbtn.innerHTML = 'å±•å¼€';
            } else {
                container.firstChild.firstChild.classList.add('unfold');
                unfoldbtn.innerHTML = 'æŠ˜å ';
            }
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(unfoldbtn);
        }
    });
</script></body>
</html>
